<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Admin – Add Quiz Question</title>

  <link rel="stylesheet" href="css/Style.css">
  <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&display=swap" rel="stylesheet">
  
</head>

<body class="form-body">

  
  <nav>
    <H1>Learn.Py</H1>
    <ul>
        <li onclick="window.location.href='index.html'">Home</li>
        <li onclick="window.location.href='Info.html'">Info</li>
        <li onclick="window.location.href='Compiler.html'">Compiler</li>
        <li onclick="location='admin.html'">Admin</li>
        <li><button id="login"><a id="loginlink" href="login.html">login</a></button></li>
    </ul>
    </nav >
    <script>
        // if the user is loged in replace the login button with view profile 
        $(function () {
          $.getJSON('php/check_session.php', data => {
            if (data.loggedIn) {
              $('#loginlink')
                .text('Profile')
                .attr('href', 'profile.html')
                .parent()          
                .addClass('logged-in');
            }
          });
        });
        </script>


  
  <div id="big-div" class="admin-card">
    <h2>Add a new Quiz Question</h2>

    <form id="qForm">

      <div class="row"> 
        <textarea name="question" class="quizbox"
                  placeholder="Question text…" required></textarea>
      </div>

      <div class="row">
        <input name="op1" type="text" placeholder="Option 1" class="quiz" required>
        <input name="op2" type="text" placeholder="Option 2" class="quiz" required>
        <input name="op3" type="text" placeholder="Option 3" class="quiz" required>
        <input name="op4" type="text" placeholder="Option 4" class="quiz" required>
      </div>

      <div class="row">
        <label>Quiz&nbsp;#
          <select name="quiz" class="quiz" required>
             <option value="0">0</option>
             <option value="1">1</option>
             <option value="2">2</option>
          </select>
        </label>

        <label>Correct&nbsp;
          <select name="answer" class="quiz" required>
            <option value="" disabled selected hidden>–</option>
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
        </label>
      </div>

      <div class="row">
        <button type="submit" class="save">Save question</button>
        <span id="msg" style="color:red;"></span>
      </div>

    </form>
  </div>

  <footer id="home-foot"><p>&COPY;Learn.py&nbsp;2025 | All Rights Reserved.</p></footer>

  <script>
  
  const form=document.getElementById('qForm'),
        msg =document.getElementById('msg');

  form.addEventListener('submit', async e=>{
    e.preventDefault();
    msg.style.color='grey'; msg.textContent='Saving…';
    try{
      const res  = await fetch('php/add_question.php',
                               { method:'POST', body:new FormData(form) });
      const data = await res.json();
      if (data.ok){
        msg.style.color='green'; msg.textContent='✔ Saved (id '+data.id+')';
        form.reset();
      } else {
        msg.style.color='red';   msg.textContent=data.error||'Error';
      }
    } catch {
      msg.style.color='red'; msg.textContent='Access restricted! Admins only';
    }
  });
  </script>
</body>
</html>
